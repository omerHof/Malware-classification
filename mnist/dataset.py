import cv2

import os, glob
import matplotlib.pylab as plt
from os import listdir, makedirs
from os.path import isfile, join
import pandas as pd
import PIL
import numpy as np

pth = '/sise/home/szoke/malware-classification/malware_images'

folders = os.listdir(pth)

all_data = []
for folder in folders:
    pth_upd = pth + '/' + folder
    # print(pth_upd)

    allfiles = os.listdir(pth_upd)
    files = []
    columns = ['data']
    index = [folders]
    for file in allfiles:
        files.append(file) if ('.png' in file) else None

    for file in files:
        img = cv2.imread(os.path.join(pth_upd, file), cv2.IMREAD_GRAYSCALE)

        # print(img)
        # read image
        img = cv2.resize(img, (28, 28))
        img = list(img.reshape(-1))
        img.insert(0, folders.index(folder))
        all_data.append(img)

pd.DataFrame(all_data).to_csv('all_data.csv', index=False)
